<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EM datagrams on *.kmall format: Overview of EM datagrams on *.kmall format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="KMlogo.PNG"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EM datagrams on *.kmall format
   &#160;<span id="projectnumber">Reg.no. 410224 rev F</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Overview of EM datagrams on *.kmall format </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h3>Introduction</h3>
<p>The .kmall format is the successor of the .all format, and uses the file extension *.kmall. Water column data can be logged in a separate file with extension *.kmwcd. The format is a generic format with high resolution data and the structure of the datagrams is designed to make updates easier. <br />
 <br />
 Kongsberg multibeam echosounder systems, MBES, also refered to as the EM series echosounders are controlled and configured using the K-Controller and can acquire and log data using Kongsbergâ€™s Seabed Information System (SIS) or other third party acquisition software. K-Controller runs on Windows. Data from the MBES is received via an Ethernet connection as UDP packets of variable length. The UDP packages containing output datagrams are usually logged to disk on a hydrographic work station (HWS). The output datagrams may also be exported to user provided programs on the HWS or on an external Ethernet network or from the echosounder by multicast distribution.</p>
<h3>Detailed specifications</h3>
<p>.kmall files are named according to nnnn_YYYYMMDD_HHMMSS, where nnnn is the line number, followed by date and time. The timestamp in the first datagram in the file is decoded and used in the filename. (Note that the clock in the PC is not used). The ship's name may be appended at the end of the file name by the operator if wanted: nnnn_YYYYMMDD_HHMMSS_ShipName.<br />
 <br />
 The majority of the output datagrams are in binary format. The datagrams have 4 bytes alignment. Little endian and C++11 data types are used. All datagrams starts with the general header, <a class="el" href="structEMdgmHeader__def.html" title="Definition of general datagram header. ">EMdgmHeader_def</a>, and ends with a 32 bit unsigned value containing the size of the datagram, in number of bytes. The length field at the start and end of the datagram are included in the length count. Thus to read the file, first read four bytes, then read that number of bytes from the file which is then one datagram. <br />
 <br />
 The name of the datagram is found in the general header. It starts with #, then a three letter code follows. Tables of output datagrams are given below.<br />
 <br />
 The datagrams from the echosounder are received in one stream. The timestamp of the data may not be strictly sequential. For example, motion sensor data is grouped together and sent from the echosounder to SIS/K-Controller in one datagram containing up to 100 motion sensor measurements with individual timestamps. Therefore they may arrive one second later than the position datagram. This makes it necessary to read several motion sensor datagrams to find the correct one to be used when applying motion to the depth data. The individual datagram types must be handled separately and the interpolation to other datagram types must be done based on the timestamps.<br />
 <br />
 The external sensor (S) datagrams contain information from sensors other than the echosounder. The datagrams may contain both corrected data and data as received from the sensor. The corrected data are data as used during the raytracing and depth calculations by the processing unit (PU) in real-time. Corrected data are only provided for active sensors. For post processing purposes the raw data are provided, also for inactive sensors. Generally, raw data has the same format as the external sensors provide. E.g. raw position data from GGA are presented as a text string according to the NMEA standard: <br />
 <em> $INGGA,094354.04,5925.695652,N,01027.921711,E,4,07,1.3,-1.55,M,40.51,M,1.0,0000*7D </em><br />
 <br />
</p>
<h3>Lists of output datagrams from processing unit (PU): </h3>
<h4>Installation and runtime datagrams:</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Datagram type code  </th><th class="markdownTableHeadNone">Datagram struct name  </th><th class="markdownTableHeadNone">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#IIP  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmIIP__def.html" title="Definition of #IIP datagram containing installation parameters and sensor format settings.   Details in separate document Installation parameters ">EMdgmIIP_def</a>  </td><td class="markdownTableBodyNone">Installation parameters and sensor setup.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">#IOP  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmIOP__def.html" title="Definition of #IOP datagram containing runtime parameters, exactly as chosen by operator in the K-Con...">EMdgmIOP_def</a>  </td><td class="markdownTableBodyNone">Runtime parameters as chosen by operator.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#IBE  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmIB__def.html" title="#IB - Results from online built in test (BIST). Definition used for three different BIST datagrams...">EMdgmIB_def</a>  </td><td class="markdownTableBodyNone">Built in test (BIST) error report.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">#IBR  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmIB__def.html" title="#IB - Results from online built in test (BIST). Definition used for three different BIST datagrams...">EMdgmIB_def</a>  </td><td class="markdownTableBodyNone">Built in test (BIST) reply.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#IBS  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmIB__def.html" title="#IB - Results from online built in test (BIST). Definition used for three different BIST datagrams...">EMdgmIB_def</a>  </td><td class="markdownTableBodyNone">Built in test (BIST) short reply.   </td></tr>
</table>
<h4>Multibeam datagrams:</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Datagram type code  </th><th class="markdownTableHeadNone">Datagram struct name  </th><th class="markdownTableHeadNone">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#MRZ  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmMRZ__def.html" title="#MRZ - Multibeam Raw Range and Depth datagram. The datagram also contains seabed image data...">EMdgmMRZ_def</a>  </td><td class="markdownTableBodyNone">Multibeam (M) raw range (R) and depth(Z) datagram   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">#MWC  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmMWC__def.html" title="#MWC - Multibeam Water Column Datagram. Entire datagram containing several sub structs. ">EMdgmMWC_def</a>  </td><td class="markdownTableBodyNone">Multibeam (M) water (W) column (C) datagram   </td></tr>
</table>
<h4>External sensor output datagrams:</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Datagram type code  </th><th class="markdownTableHeadNone">Datagram struct name  </th><th class="markdownTableHeadNone">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#SPO  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmSPO__def.html" title="#SPO - Struct of position sensor datagram.     Data from active sensor will be motion corrected if in...">EMdgmSPO_def</a>  </td><td class="markdownTableBodyNone">Sensor (S) data for position (PO)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">#SKM  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmSKM__def.html" title="#SKM - data from attitude and attitude velocity sensors. ">EMdgmSKM_def</a>  </td><td class="markdownTableBodyNone">Sensor (S) KM binary sensor format   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#SVP  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmSVP__def.html" title="#SVP - Sound Velocity Profile. Data from sound velocity profile or from CTD profile. Sound velocity is measured directly or estimated, respectively. ">EMdgmSVP_def</a>  </td><td class="markdownTableBodyNone">Sensor (S) data from sound velocity (V) profile (P) or CTD   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">#SVT  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmSVT__def.html" title="#SVT - Sound Velocity at Transducer. Data for sound velocity and temperature are measured directely o...">EMdgmSVT_def</a>  </td><td class="markdownTableBodyNone">Sensor (S) data for sound velocity (V) at transducer (T)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#SCL  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmSCL__def.html" title="#SCL - CLock datagram. ">EMdgmSCL_def</a>  </td><td class="markdownTableBodyNone">Sensor (S) data from clock (CL)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">#SDE  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmSDE__def.html" title="#SDE - Depth datagram. ">EMdgmSDE_def</a>  </td><td class="markdownTableBodyNone">Sensor (S) data from depth (DE) sensor   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#SHI  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmSHI__def.html" title="#SHI - Height datagram. ">EMdgmSHI_def</a>  </td><td class="markdownTableBodyNone">Sensor (S) data for height (HI)   </td></tr>
</table>
<h4>Compatibility datagrams:</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Datagram type code  </th><th class="markdownTableHeadNone">Datagram struct name  </th><th class="markdownTableHeadNone">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#CPO  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmCPO__def.html" title="#CPO - Struct of compatibility position sensor datagram.     Data from active sensor will be motion c...">EMdgmCPO_def</a>  </td><td class="markdownTableBodyNone">Compatibility (C) data for position (PO)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">#CHE  </td><td class="markdownTableBodyNone"><a class="el" href="structEMdgmCHE__def.html" title="#CHE - Struct of compatibility heave sensor datagram.     Used for backward compatibility with ...">EMdgmCHE_def</a>  </td><td class="markdownTableBodyNone">Compatibility (C) data for heave (HE)   </td></tr>
</table>
<p><br />
 <br />
 <br />
 <br />
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
