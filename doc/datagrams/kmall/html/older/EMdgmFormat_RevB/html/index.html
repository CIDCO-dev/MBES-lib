<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>EM datagrams on *.kmall format: Overview of EM datagrams on .*kmall format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="KMlogo.PNG"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EM datagrams on *.kmall format
   &#160;<span id="projectnumber">Reg.no. 410224 rev B</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Overview of EM datagrams on .*kmall format </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Introduction</b> <br />
 The K-Controller is responsible for logging all the data from the Kongsberg multibeam echosounder systems, MBES, also refered to as the EM series echosounders. K-Controller runs on a PC-architecture computer running Windows. Data from the MBES arrives at the PC via an Ethernet connection as UDP packets of variable length. The UDP packages containing output datagrams are usually logged to disk on a hydrographic work station (HWS). The output datagrams may also be exported to user provided programs on the HWS or on an external Ethernet network or from the echosounder by multicast distribution. <br />
 <br />
 To separate the EM datagrams described herein from previous EM datagram formats, the file extension of this format is called *.kmall. Files are named according to nnnn_YYYYMMDD_HHMMSS, where nnnn is the line number, followed by date and time. Time in the first datagram in the file is decoded and used in the filename. (Note that the clock in the PC is not used).The ship's name may be appended at the end of the file name by operators choice: nnnn_YYYYMMDD_HHMMSS_ShipName.<br />
 <br />
 The majority of the output datagrams are in binary format. The datagrams have 4 bytes alignment. Little endian and C++11 data types are used. All datagrams starts with the general header, <a class="el" href="structEMdgmHeader__def.html" title="Definition of general datagram header. ">EMdgmHeader_def</a>, and ends with a 32 bit unsigned value containing the size of the datagram, in number of bytes. The length field at the start and end of the datagram are included in the length count. Thus to read the file, first read four bytes, then read that number of bytes from the file which is then one datagram. <br />
 <br />
 In the general header, the name of the datagram is found. The name of the datagram start by #, then a three letter code follows. Tables of output datagrams are given below.<br />
 <br />
 The datagrams from the echosounder arrives at the PC in one stream. The timestamp of the data may not be strictly sequential. For example motion sensor data is grouped together and sent from the echosounder to SIS/K-Controller in one datagram containing up to 100 motion sensor measurements with individual timestamps. Therefore they may arrive one second later than the depth datagram. This makes it necessary to read several motion sensor datagrams to find the correct one to be used when applying motion to the depth data. The individual datagram types must be handled separately and the interpolation to other datagram types must be done based on the timestamps.<br />
 <br />
 The external sensor (S) datagrams contain information from sensors other than the echo sounder. The datagrams may contain both corrected data and data as received from the sensor. The corrected data are data as used during the raytracing and depth calculations by the processing unit (PU) in real-time. For post processing purposes the raw data are provided, generally in the same format as the external sensors provide the data. E.g. raw position data from GGA are presented as a text string according to the NMEA standard: <em> $INGGA,094354.04,5925.695652,N,01027.921711,E,4,07,1.3,-1.55,M,40.51,M,1.0,0000*7D </em><br />
 <br />
 <br />
 <b>Lists of output datagrams from processing unit (PU): </b><br />
 <br />
 <br />
 <b>Installation and runtime datagrams:</b><br />
 </p><table class="doxtable">
<tr>
<th>Datagram type code </th><th>Datagram struct name </th><th>Description </th><th>Comment  </th></tr>
<tr>
<td>#IIP </td><td><a class="el" href="structEMdgmIIP__def.html" title="Definition of #IIP datagram containing installation parameters and sensor format settings.   Details in separate document Installation parameters ">EMdgmIIP_def</a> </td><td>Installation parameters and sensor setup. </td><td>Beta release </td></tr>
<tr>
<td>#IOP </td><td><a class="el" href="structEMdgmIOP__def.html" title="Definition of #IOP datagram containing runtime parameters, exactly as chosen by operator in the K-Con...">EMdgmIOP_def</a> </td><td>Runtime parameters as chosen by operator. </td><td>Beta release </td></tr>
<tr>
<td>#IBE </td><td><a class="el" href="structEMdgmIB__def.html" title="#IB - Results from online built in test (BIST). Definition used for three different BIST datagrams...">EMdgmIB_def</a> </td><td>Built in test (BIST) error report. </td><td>Not available in beta release </td></tr>
<tr>
<td>#IBR </td><td><a class="el" href="structEMdgmIB__def.html" title="#IB - Results from online built in test (BIST). Definition used for three different BIST datagrams...">EMdgmIB_def</a> </td><td>Built in test (BIST) reply. </td><td>Not available in beta release </td></tr>
<tr>
<td>#IBS </td><td><a class="el" href="structEMdgmIB__def.html" title="#IB - Results from online built in test (BIST). Definition used for three different BIST datagrams...">EMdgmIB_def</a> </td><td>Built in test (BIST) short reply. </td><td>Not available in beta release </td></tr>
</table>
<p><br />
 <b>Table of multibeam datagrams:</b><br />
 </p><table class="doxtable">
<tr>
<th>Datagram type code </th><th>Datagram struct name </th><th>Description </th><th>Comment  </th></tr>
<tr>
<td>#MRZ </td><td><a class="el" href="structEMdgmMRZ__def.html" title="#MRZ - Multibeam Raw Range and Depth datagram. The datagram also contains seabed image data...">EMdgmMRZ_def</a> </td><td>Multibeam (M) raw range (R) and depth(Z) datagram </td><td>Beta release </td></tr>
<tr>
<td>#MWC </td><td><a class="el" href="structEMdgmMWC__def.html" title="#MWC - Multibeam Water Column Datagram. Entire datagram containing several sub structs. ">EMdgmMWC_def</a> </td><td>Multibeam (M) water (W) column (C) datagram </td><td>Not available in beta release </td></tr>
</table>
<p><br />
 <b>Table of external sensor output datagrams:</b><br />
 </p><table class="doxtable">
<tr>
<th>Datagram type code </th><th>Datagram struct name</th><th>Description </th><th>Comment  </th></tr>
<tr>
<td>#SPO </td><td><a class="el" href="structEMdgmSPO__def.html" title="#SPO - Struct of position sensor datagram. ">EMdgmSPO_def</a> </td><td>Sensor (S) data for position (PO) </td><td>Beta release </td></tr>
<tr>
<td>#SKM </td><td><a class="el" href="structEMdgmSKM__def.html" title="#SKM - data from attitude and attitude velocity sensors. ">EMdgmSKM_def</a> </td><td>Sensor (S) KM binary sensor format </td><td>Beta release </td></tr>
<tr>
<td>#SVP </td><td><a class="el" href="structEMdgmSVP__def.html" title="#SVP - Sound Velocity Profile. Data from sound velocity profile or from CTD profile. Sound velocity is measured directly or estimated, respectively. ">EMdgmSVP_def</a> </td><td>Sensor (S) data from Sound Velocity (V) Profile (P) or CTD </td><td>Beta release </td></tr>
<tr>
<td>#SCL </td><td><a class="el" href="structEMdgmSCL__def.html" title="#SCL - CLock datagram. ">EMdgmSCL_def</a> </td><td>Sensor (S) data from clock (CL) </td><td>Beta release </td></tr>
<tr>
<td>#SDE </td><td><a class="el" href="structEMdgmSDE__def.html" title="#SDE - DEpth datagram. ">EMdgmSDE_def</a> </td><td>Sensor (S) data from depth (DE) sensor </td><td>Not available in beta release </td></tr>
<tr>
<td>#SHI </td><td><a class="el" href="structEMdgmSHI__def.html" title="#SHI - Height datagram. ">EMdgmSHI_def</a> </td><td>Sensor (S) data for height (HI) </td><td>Not available in beta release </td></tr>
<tr>
<td>#SHA </td><td><a class="el" href="structEMdgmSHA__def.html" title="#SHA - Heading ">EMdgmSHA_def</a> </td><td>Sensor (S) data for heading (HA) </td><td>Not available in beta release </td></tr>
</table>
<p><br />
 <br />
 <br />
 <br />
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
